
<html lang="zxx">
<head>
 <meta charset="utf-8">
 <meta name="description" content="Outo">
 <meta name="keywords" content="HTML,CSS,JavaScript">
 <meta name="author" content="EnvyTheme">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
 <title>Outo - Furniture Shop HTML Template</title>
 <link rel="icon" href="assets/images/favicon.png" type="image/png" sizes="16x16">

 <link rel="stylesheet" href="assets/css/bootstrap.min.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/animate.min.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/owl.carousel.min.css" type="text/css" media="all" />
 <link rel="stylesheet" href="assets/css/owl.theme.default.min.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/meanmenu.min.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/magnific-popup.min.css" type="text/css" media="all" />

 <link rel='stylesheet' href='assets/css/flaticon.css' type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/nice-select.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/style.css" type="text/css" media="all" />

 <link rel="stylesheet" href="assets/css/responsive.css" type="text/css" media="all" />
</head>
<body>

<div class="preloader">
 <div class="preloader-wrapper">
  <div class="preloader-content">
   <div class="blob-1"></div>
   <div class="blob-2"></div>
   <input type="text" id="ipuid" style="display: none">
  </div>
 </div>
</div>





<header class="header header-page-bg">
 <div class="container">
  <div class="header-page-content">
   <div class="row align-items-center">
    <div class="col-md-7">
     <div class="header-content">
      <h1>My Orders</h1>
      <nav aria-label="breadcrumb">
       <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/HomePage/index.jsp">主页</a></li>
        <li class="breadcrumb-item active" aria-current="page">我的订单</li>
       </ol>
      </nav>
     </div>
    </div>
    <div class="col-md-5 d-none d-md-block">
     <div class="header-content-image header-content-abs-image header-content-abs-top">
      <img src="assets/images/inner-page-header/page-1.png" alt="page">
     </div>
    </div>
   </div>
  </div>
 </div>
</header>


<div class="account-page-section pt-100 pb-70">
 <div class="container">
  <div class="row">
   <div class="col-sm-12 col-md-4 col-lg-4 pb-30">
    <div class="account-sidebar">
     <ul class="account-sidebar-list">
      <li><a href="my-account.html">我的信息</a></li>
      <li class="active"><a href="my-orders.html">我的订单</a></li>
      <li><a href="my-addresses.html">我的地址</a></li>
      <li><a href="#" id="loginout">退出登录</a></li>
     </ul>
    </div>
   </div>
   <div class="col-sm-12 col-md-8 col-lg-8 pb-30">
    <div class="account-info">
     <div class="my-order">
      <div class="sub-section-title sub-section-title-white">
       <h2 class="sub-section-title-heading">我的订单</h2>
      </div>
      <div class="product-list-form">
       <form>
        <select class="product-sort">
         <option value="default-sorting">Sort by latest</option>
         <option value="popularity">Sort by popoularity</option>
         <option value="lowtohigh">Sort by price: low to high</option>
         <option value="hightolow">Sort by price: high to low</option>
        </select>
       </form>
      </div>
     </div>
     <div class="cart-table cart-table-white">
      <div id="backdiv" style="display: none"> <button onclick="back()" >返回</button></div>
      <table id="t2">

       <tr>
        <td>订单编号</td>
        <td>创建时间</td>
        <td>订单状态</td>
        <td>订单价格</td>
        <td>操作</td>
        <td>用户账号</td>
       </tr>

      </table>
      <div><table id="t3" >
       <tr style="border: none">
        <td style="border: none" width="250">每页<span id="rows"></span>条,共<span id="totalPage"></span>页,共<span id="totalCount"></span>条</td>
        <td style="border: none" ><button onclick="FirstPage()">首页</button></td>
        <td style="border: none" ><button onclick="lastPage()">上一页</button></td>
        <td style="border: none" width="50"><input type="text" id="currentPage" STYLE="width: 50px"></td>
        <td style="border: none"><button onclick="skipPage()">跳转</button></td>
        <td style="border: none"><button onclick="nextPage()">下一页</button></td>
        <td style="border: none"><button onclick="FinalPage()">尾页</button></td>
       </tr>
      </table>
      </div>
     </div>
     <div class="cart-table cart-table-white"  id="d1" style="display: none";>
      <br><hr>
      <button onclick="hide()">收起</button>
      <table id="t1">

       <tr>
        <td>订单编号</td>
        <td>商品名称</td>
        <td>商品数量</td>
        <td>商品价格</td>
       </tr>

      </table>
     </div>

    </div>
   </div>
  </div>
 </div>
</div>





<div class="scroll-top" id="scrolltop">
 <div class="scroll-top-inner scroll-top-inner-secondcolor">
  <i class="flaticon-up-arrow"></i>
 </div>
</div>


<script src="assets/js/jquery-3.5.1.min.js"></script>
<script src="assets/js/bootstrap.bundle.min.js"></script>

<script src="assets/js/jquery-ui.js"></script>

<script src="assets/js/jquery.magnific-popup.min.js"></script>

<script src="assets/js/owl.carousel.min.js"></script>

<script src="assets/js/jquery.nice-select.min.js"></script>

<script src="assets/js/isotope.pkgd.min.js"></script>

<script src="assets/js/jquery.ajaxchimp.min.js"></script>

<script src="assets/js/form-validator.min.js"></script>

<script src="assets/js/contact-form-script.js"></script>

<script src="assets/js/jquery.meanmenu.min.js"></script>

<script src="assets/js/script.js"></script>

<script type="text/javascript">
 window.onload=function () {
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {

   if (this.readyState == 4 && this.status == 200) {

    var data=this.responseText;
    var jsonObj=JSON.parse(data);
    var utype=jsonObj.utype;
    if (utype!=3){
     document.getElementById("backdiv").style.display="block";
    }
    //id
    var uid=jsonObj.uid;

    document.getElementById("ipuid").value=uid;
    List();
   }
  }
  xhttp.open("post","/accountInfoOnload?service=userInformationList",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();

 }

 function List() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function () {
   if (this.readyState == 4 && this.status == 200) {
    var data = this.responseText;
    var jsonObj = JSON.parse(data);

    //每页数量
    var rows=jsonObj.rows;
    document.getElementById("rows").innerHTML=rows;
    //记录数
    var totalCount=jsonObj.totalCount;
    document.getElementById("totalCount").innerHTML=totalCount;
    //总页数
    var totalPage=jsonObj.totalPage;
    document.getElementById("totalPage").innerHTML=totalPage;
    //当前页
    var currentPage=jsonObj.currentPage;
    document.getElementById("currentPage").value=currentPage;
    //每页多少条


    var tableElement2 = document.getElementById("t2");
    for (let i = 0; i < jsonObj.list.length; i++) {
     var trEle2 = document.createElement("tr");
     var temp="未完成";
     if (jsonObj.list[i].statue==1){
      temp="以完成";
     }
     trEle2.innerHTML = "<td width=\"100\" align=\"center\" height=\"50\">" + jsonObj.list[i].oid + "</td>"
             + "<td width=\"350\" align=\"center\">" + jsonObj.list[i].createtime+ "</td>"
             + "<td width=\"250\" align=\"center\">" + temp + "</td>"
             + "<td width=\"100\" align=\"center\">" + jsonObj.list[i].totalprice + "</td>"
             + "<td width=\"350\" align=\"center\"><button  onclick=s('" + jsonObj.list[i].oid+ "')>查看详情</button></td>" +
             "<td width=\"100\" align=\"center\">" + jsonObj.list[i].uid+ "</td>"

     tableElement2.append(trEle2);


    }
   }
  }
  xhttp.open("post", "/accountInfoOnload?service=FindProductByPage", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function hide(){
  document.getElementById("d1").style.display="none";
 }


 function s(oid){
  document.getElementById("d1").style.display="block";
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function () {

   if (this.readyState == 4 && this.status == 200) {

    var data = this.responseText;

    var jsonObj = JSON.parse(data);



    var tableElement2 = document.getElementById("t1");
    for (let i = 0; i < jsonObj.length; i++) {
     var trEle2 = document.createElement("tr");
     var temp="未完成";
     if (jsonObj[i].statue==1){
      temp="以完成";
     }
     trEle2.innerHTML = "<td width=\"100\" align=\"center\" height=\"50\">" + jsonObj[i].oid + "</td>"
             + "<td width=\"250\" align=\"center\">" + jsonObj[i].gname+ "</td>"
             + "<td width=\"100\" align=\"center\">" + jsonObj[i].gnum + "</td>"
             + "<td width=\"100\" align=\"center\">" + jsonObj[i].price + "</td>"

     tableElement2.append(trEle2);
    }
   }
  }
  xhttp.open("post", "/accountInfoOnload?service=userOrderInformationList&uid=" + oid + "", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();}



 function lastPage(){
  var currentPage=document.getElementById("currentPage").value;
  var totalPage=document.getElementById("totalPage").innerHTML;
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {
   if (this.readyState == 4 && this.status == 200) {

    window.location.reload();

   }
  }

  xhttp.open("post","/accountInfoOnload?service=updatePage&message=lastPage&currentpage="+currentPage+"&totalPage="+totalPage+"",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function skipPage(){
  var currentPage=document.getElementById("currentPage").value;
  var totalPage=document.getElementById("totalPage").innerHTML;
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {
   if (this.readyState == 4 && this.status == 200) {

    window.location.reload();

   }
  }

  xhttp.open("post","/accountInfoOnload?service=updatePage&message=skipPage&currentpage="+currentPage+"&totalPage="+totalPage+"",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function nextPage(){
  var currentPage=document.getElementById("currentPage").value;
  var totalPage=document.getElementById("totalPage").innerHTML;
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {
   if (this.readyState == 4 && this.status == 200) {

    window.location.reload();

   }
  }

  xhttp.open("post","/accountInfoOnload?service=updatePage&message=nextPage&currentpage="+currentPage+"&totalPage="+totalPage+"",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function FirstPage(){
  var currentPage=document.getElementById("currentPage").value;
  var totalPage=document.getElementById("totalPage").innerHTML;
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {
   if (this.readyState == 4 && this.status == 200) {

    window.location.reload();

   }
  }

  xhttp.open("post","/accountInfoOnload?service=updatePage&message=FirstPage&currentpage="+currentPage+"&totalPage="+totalPage+"",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function FinalPage(){
  var currentPage=document.getElementById("currentPage").value;
  var totalPage=document.getElementById("totalPage").innerHTML;
  var xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange=function () {
   if (this.readyState == 4 && this.status == 200) {

    window.location.reload();

   }
  }

  xhttp.open("post","/accountInfoOnload?service=updatePage&message=FinalPage&currentpage="+currentPage+"&totalPage="+totalPage+"",true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send();
 }
 function back(){
  alert("返回商品管理界面")
  window.location.href="/html/adminInit.html"
 }

 $("#loginout").click(function (){
  var result = confirm("确定要退出吗");
  if (result) {
   window.location.href = "http://localhost:8080/userinfo?service=OutLogin";
  }
 })
</script>
<style>
 tr,td,th{
  border:1px solid;

 }
</style>
</body>
</html>
